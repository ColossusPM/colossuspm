<div class="px-3 md:px-6 lg:px-8 xl:px-10">
  <div class="flex justify-content-between align-items-center mb-4">
    <h2 class="text-2xl font-medium">All Projects</h2>
    <p-button label="New Project" severity="success" (click)="showModal()"></p-button>
  </div>

  @if (projects.length === 0) {
    <p-message severity="info" text='No projects found. Click "New Project" to get started.' class="w-full"></p-message>
  }

  @if (projects.length > 0) {
    <div class="flex flex-column gap-3 mt-3">
      <p-card *ngFor="let project of projects" class="border-round-xl">
        <ng-template pTemplate="header">
          <div class="flex justify-content-between align-items-center pr-4 pl-4 pt-4">
            <h5 class="m-0 text-xl">{{ project.name || "Untitled Project" }}</h5>
            <p-button icon="pi pi-arrow-right" class="p-button-sm" severity="info" (click)="openProject(project)"></p-button>
          </div>
        </ng-template>
      </p-card>
    </div>
  }

  <p-dialog [(visible)]="displayModal" [modal]="true" [style]="{ width: '30rem' }" header="Create New Project" [closable]="false" class="border-round-xl">
    <form [formGroup]="form" (ngSubmit)="create()" class="p-fluid py-2">
      <div class="field mb-4">
        <label for="name" class="block mb-2 font-medium">Project Name</label>
        <input
          pInputText
          id="name"
          type="text"
          class="w-full"
          formControlName="name"
          placeholder="Enter project name"
          [ngClass]="{ 'p-invalid': form.get('name')?.invalid && form.get('name')?.touched }"
        />
        @if (form.get('name')?.invalid && form.get('name')?.touched) {
          <small class="p-error mt-2 block">Project name is required.</small>
        }
      </div>

      <div class="field mb-4">
        <label for="description" class="block mb-2 font-medium">Description</label>
        <textarea
          pTextarea
          id="description"
          rows="3"
          class="w-full"
          formControlName="description"
          placeholder="Enter description"
        ></textarea>
      </div>

      <div class="flex justify-content-end gap-2 pt-2">
        <p-button
          label="Cancel"
          severity="secondary"
          (click)="hideModal()"
        ></p-button>
        <p-button
          type="submit"
          label="Create"
          [disabled]="form.invalid"
          severity="success"
        ></p-button>
      </div>
    </form>
  </p-dialog>
</div>
